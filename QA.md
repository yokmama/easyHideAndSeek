# Hide and Seek - 質問と検討事項

## ゲームバランスに関する検討

### Q1: 最適なゲーム時間は？
**現状**: 10分（推奨）
**検討事項**:
- 10分がちょうど良い緊張感を保てる時間
- 短すぎる（5分以下）：シーカーが不利
- 長すぎる（15分以上）：ハイダーが退屈
**結論**: 10分をデフォルトとし、設定で変更可能に

### Q2: シーカーとハイダーの人数比は？
**現状**: 23%がシーカー（13人なら3人）
**検討事項**:
- この比率が最もバランスが良い
- 人数による自動計算式を実装
**計算式**: 
```
シーカー数 = Math.ceil(総人数 × 0.23)
```

### Q3: 見逃しアイテムの価格設定は？
**現状**: 500コイン（1個限定）
**検討事項**:
- 高すぎる：使用率が低下
- 安すぎる：ゲームバランスが崩壊
**バランス案**:
- 参加報酬100 + 勝利報酬1000なので、500は妥当
- 購入制限1個で乱用防止

## 技術的な課題

### Q4: 偽装システムの実装方法は？
**実装方法**:
- ショップGUIでブロック選択
- プレイヤーの足元（立っている位置）に実ブロックを設置
- プレイヤーに透明化エフェクト付与
- PlayerMoveEventで移動検出→偽装解除
**技術詳細**:
- 元の位置は空気か液体なので保存不要
- HashMap<Location, UUID>で位置管理
- BlockDamageEventで攻撃検出
- 同一位置への重複偽装は事前チェックで防止

### Q5: Vault連携の必須化は？
**現状**: 必須依存
**検討事項**:
- 必須にすることで経済システムが確実に動作
- オプションにすると設定が複雑化
**結論**: 必須のままで、Vaultは一般的なので問題なし

### Q6: 既存マップ使用時の保護は？
**実装方針**: 既存マップをそのまま使用
**保護機能**:
- BlockBreakEvent: ゲーム中は全てキャンセル
- BlockPlaceEvent: ゲーム中は全てキャンセル（偽装ブロック除く）
- 偽装ブロックは一時的で、ゲーム終了時に削除
**境界処理**:
- 座標ベースの円形/矩形エリア指定
- プレイヤー位置を定期チェック
- エリア外に出たら警告→強制テレポート

## ゲームプレイに関する質問

### Q7: 偽装中の移動制限は？
**現状**: 一歩でも動くと偽装解除
**メリット**:
- 緊張感のあるゲームプレイ
- リスクとリターンのバランス
**技術的実装**:
- PlayerMoveEventで座標変化を検出
- X/Y/Z座標の0.1ブロック以上の変化で解除
**検討事項**: 視点移動（マウス）は許可するか？
→ 許可（位置が変わらなければOK）

### Q8: 役割別ショップの内容は？
**ハイダー用**:
- 偽装ブロック選択（無料）
- 見逃しアイテム（500コイン）
**シーカー用**:
- コンパス（200コイン）
- スピードブースト（300コイン）
- エリアスキャン（500コイン）
**バランス考慮**:
- シーカーにも戦略的選択肢を提供
- 価格設定で使用頻度を調整

### Q9: 準備時間30秒は適切？
**現状**: 30秒固定
**検討事項**:
- マップサイズによって調整すべき？
- 小マップ：20秒
- 中マップ：30秒
- 大マップ：40秒
**結論**: まずは30秒固定で実装

## プレイヤー体験

### Q10: 捕獲された後のプレイヤーの扱いは？
**現状**: 観戦モード
**利点**:
- 公平性が保たれる
- 情報漏洩なし
- シンプルな実装
**代替案**: 
- Infection Mode（捕獲されたらシーカーになる）は別モードとして実装

### Q11: 初心者支援機能は？
**提案機能**:
- 初回プレイボーナス（500コイン）
- ゲーム開始時のルール説明
- /hs tutorial コマンド
**実装優先度**: 低（まずは基本機能を優先）

### Q12: 観戦機能の充実度は？
**現在**: 基本的な観戦モード
**追加機能案**:
- 俯瞰視点
- プレイヤー追跡カメラ
- ハイライト表示（誰が偽装中か）
- 統計リアルタイム表示
**懸念**: 配信での情報漏洩

## パフォーマンス最適化

### Q13: 同時開催可能なゲーム数は？
**想定**: 1サーバーで複数アリーナ同時実行
**制限要因**:
- プレイヤー数（最大30人×アリーナ数）
- タイマー処理
- 経済処理の非同期化
**目標**: 2-3ゲーム同時開催で TPS 19+ 維持

### Q14: 大規模マップでの最適化は？
**課題**: 100×100以上のマップでの処理
**最適化案**:
1. チャンク単位でのプレイヤー管理
2. 視界外の偽装処理スキップ
3. LOD的な処理（遠距離は簡略化）

## 拡張性

### Q15: API設計の方針は？
**公開すべきAPI**:
- ゲームイベント
- 偽装システム
- 能力システム
- 統計アクセス
**質問**: どの程度の自由度を提供？

### Q16: 他プラグインとの連携優先順位は？
**連携候補**:
1. **必須**: Vault（経済）
2. **推奨**: PlaceholderAPI
3. **オプション**: 
   - Discord連携
   - ランキングボード
   - アンチチート
**質問**: 特定プラグイン依存を避けるべき？

## データ管理

### Q17: 統計データの保持期間は？
**現状**: 無期限保存想定
**保存データ**:
- 総プレイ回数
- 勝利回数（シーカー/ハイダー）
- 総捕獲数
- 総収益
**結論**: YAMLファイルで永続保存、必要に応じてリセットコマンド提供

### Q18: 設定の継承/テンプレート機能は？
**ユースケース**:
- 複数アリーナで共通設定使用
- イベント用の特殊設定
- 設定のバックアップ/復元
**実装方法**: 
- テンプレートファイル
- 設定のインポート/エクスポート

## セキュリティ/公平性

### Q19: 経済システムの悪用対策は？
**想定される問題**:
1. 故意の即退出（報酬目的）
2. 複数アカウントでの稼ぎ
3. 自動化BOT
**対策案**:
- 最小プレイ時間の設定（1分以上）
- IP制限
- 不審な行動パターンの検出

### Q20: グリーフィング対策は？
**懸念事項**:
- マップの破壊
- 他プレイヤーへの妨害
- 故意のゲーム遅延
**対策**:
- ブロック設置/破壊の無効化
- 自動キック機能
- 評価システム

## 今後の検討事項

### 追加ゲームモード
1. **Infection Mode**: 捕獲されたらシーカーになる
2. **Team Mode**: チーム対抗戦
3. **Hardcore Mode**: 見逃しアイテムなし、報酬2倍

### 新技術への対応
- Minecraft 1.22以降の新機能活用
- リソースパック自動配信
- クライアントMOD連携（オプション）

### コミュニティ機能
- マップ作成コンテスト機能
- プレイヤー作成能力の共有
- リーダーボードのシーズン制

## 未解決の設計判断

1. **デフォルト言語**: 日本語（日本のサーバー向け優先）
2. **最低サポートバージョン**: 1.21.x（最新版サポート）
3. **ライセンス**: MIT License（オープンソース）
4. **開発優先順位**: 安定性 > 基本機能 > 追加機能
5. **リリース形態**: 単体プラグイン

## フィードバック収集項目

- ゲームバランスの体感
- 操作性の評価
- 不具合・バグ報告
- 新機能要望
- パフォーマンス問題
- 他プラグインとの競合

## テストシナリオ

### シナリオ1: 最小構成
- 2人（シーカー1、ハイダー1）
- 小マップ（30×30）
- ショップ機能無効

### シナリオ2: 標準構成
- 13人（シーカー3、ハイダー10）
- 中マップ（50×50）
- 全機能有効

### シナリオ3: 最大負荷
- 30人（シーカー7、ハイダー23）
- 大マップ（100×100）
- 全機能有効、同時に2ゲーム

## 優先度マトリクス

| 機能 | 重要度 | 実装難易度 | 優先度 |
|------|--------|------------|--------|
| 攻撃による捕獲 | 高 | 低 | 最高 |
| Vault連携 | 高 | 低 | 最高 |
| ショップシステム | 高 | 中 | 高 |
| マルチアリーナ | 中 | 高 | 中 |
| 統計システム | 中 | 低 | 高 |
| API公開 | 低 | 高 | 最低 |

### Q25: 水中での偽装は？
**問題**: 水中で偽装した場合の処理
**検討事項**:
- 水中にブロックを置くと水が消える
- 偽装解除時に水を復元すべきか
**解決策**:
1. 水中での偽装を禁止
2. 水を記録して復元
3. 水中でも通常通り（空気になる）
**推奨**: シンプルに3番（水も空気扱い）

### Q26: 高さ2ブロック分の処理は？
**問題**: プレイヤーは高さ2ブロック
**検討事項**:
- 足元だけ？頭の位置も？
- 2ブロック分偽装する？
**結論**: 足元1ブロックのみ偽装（シンプルさ重視）

## 偽装システム特有の検討事項

### Q20: 偽装ブロックの選択肢は？
**現状**: 石、土、草、木、丸石、砂、砂利
**検討事項**:
- マップごとに選択可能ブロックを変更？
- レアブロックは除外（ダイヤモンドブロック等）
- 透明/半透明ブロックは除外
**結論**: 基本的な建材ブロックのみ許可

### Q21: 複数人が同じ場所で偽装したら？
**問題**: プレイヤーが同じ位置で偽装しようとする
**解決策**:
- 偽装前に位置チェック
- 既に偽装ブロックがある場合は失敗
- 「その場所は既に使用されています」と警告
**実装**: disguisedBlocks.containsKey(location)でチェック

### Q22: 偽装中のダメージ処理は？
**検討事項**:
- 偽装ブロックへの攻撃→捕獲
- プレイヤー本体への攻撃→どうする？
**結論**: 両方とも捕獲扱い（透明でも当たり判定あり）

### Q23: 偽装解除のタイミングは？
**現在の仕様**:
- 移動で解除
- 捕獲されたら解除
- ゲーム終了で解除
**追加検討**: 
- 自主的な解除コマンド？
- 時間制限？
**結論**: 移動のみで解除（シンプルさ重視）

### Q24: 既存マップのクリーンアップは？
**問題**: ゲーム終了時やサーバー再起動時の処理
**解決策**:
- ゲーム終了時：全偽装ブロックを空気に戻す
- サーバー停止時：onDisableで強制クリーンアップ
- 起動時：前回の残留ブロックチェック機能
**実装**: 
```kotlin
fun cleanupGame() {
    disguisedBlocks.keys.forEach { it.block.type = Material.AIR }
    disguisedBlocks.clear()
}
```

## 次のステップ

1. **プロトタイプ作成**: 最小機能での動作確認
2. **ユーザーテスト**: 5-10人での試遊会
3. **フィードバック収集**: アンケート実施
4. **仕様確定**: QAの解決と最終仕様決定
5. **本実装開始**: フェーズ1の開発